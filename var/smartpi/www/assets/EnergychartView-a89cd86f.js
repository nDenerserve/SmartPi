import{b as E,k as A,u as Y,d as H,_ as S,f as C,o as n,c as h,g as T,a,t as r,i as g,l as M,F as I}from"./index-b0494a4f.js";import{B as O,C as N,p as V,a as P,b as L,A as R,c as j,d as q,L as W,e as z,f as G,P as J,T as K}from"./index-c7469127.js";import{s as v,a as f}from"./subDays-98de7d03.js";import{s as y,a as b,b as _,c as B}from"./subYears-8fb79fc4.js";import{u as Q}from"./index-d7652406.js";N.register(V,P,L,R,j,q,W,z,G,J,K);const U={name:"EnergychartView",components:{MainNavigation:E,Bar:O},data:()=>({chartloaded:!1,barChartData:null,barChartOptions:{responsive:!0,maintainAspectRatio:!0,scales:{x:{title:{display:!0,text:"Time"},stacked:!0,categoryPercentage:.5,barPercentage:1},y:{title:{display:!0,text:"kWh"},stacked:!0,ticks:{reverse:!1}}}}}),methods:{fetchBarchartdata:async function(t,e,l){this.chartloaded=!1;var i;(typeof t>"u"||typeof e>"u")&&(t=new Date,e=new Date,t.setHours(0,0,0,1e3),e.setHours(23,59,59,999)),typeof l<"u"?i=`/smartpiac/barchart/value/energy/aggregate/${l}/starttime/${new Date(t).toISOString()}/stoptime/${new Date(e).toISOString()}`:i="/smartpiac/barchart/value/energy",Promise.all([A.get(i)]).then(m=>{const s=m[0].data.progressdatalist[0].data;var c,p=[s.length],o,u;c=[];for(let d=0;d<s.length;d++){o=[],typeof l>"u"&&(l="1d");for(let D=0;D<s[d].datapoint.length;D++){if(d==0){let w=new Intl.DateTimeFormat("de",{dateStyle:"short"});if(this.view=="day")t.getDate().valueOf()<e.getDate().valueOf()||t.getFullYear().valueOf()<e.getFullYear().valueOf()?w=new Intl.DateTimeFormat("de",{timeStyle:"short",dateStyle:"short"}):w=new Intl.DateTimeFormat("de",{timeStyle:"short"}),c.push(w.format(new Date(s[d].datapoint[D].time)));else if(this.view=="month"){if(l=="1d")c.push(w.format(new Date(s[d].datapoint[D].time)));else if(l=="1h")w=new Intl.DateTimeFormat("de",{timeStyle:"short",dateStyle:"short"}),c.push(w.format(new Date(s[d].datapoint[D].time)));else if(l=="1mo"){const k=new Intl.DateTimeFormat("de",{month:"short",year:"numeric"}).format;c.push(k(new Date(s[d].datapoint[D].time)))}}else if(this.view=="year"){let k=new Intl.DateTimeFormat("de",{dateStyle:"short"});if(l=="1mo"){const F=new Intl.DateTimeFormat("de",{month:"short",year:"numeric"}).format;c.push(F(new Date(s[d].datapoint[D].time)))}else l=="1d"&&c.push(k.format(new Date(s[d].datapoint[D].time)))}}s[d].field.includes("Ep")?o.push(s[d].datapoint[D].value/1e3*-1):o.push(s[d].datapoint[D].value/1e3)}switch(s[d].field){case"Ep1":{u="#E2AE12";break}case"Ep2":{u="#EEBE2F";break}case"Ep3":{u="#F1CA55";break}case"Ec1":{u="#36A2EB";break}case"Ec2":{u="#36A2EB";break}case"Ec3":{u="#6ABBF0";break}default:{u="#F25757";break}}p[d]={label:s[d].field,backgroundColor:u,data:o},console.log(p[d])}this.barChartData={labels:c,datasets:p},this.chartloaded=!0}).catch(m=>{console.log(m)}),this.startD=t,this.stopD=e},dateBack:async function(){this.view=="day"?(this.startD=v(this.startD,1),this.stopD=v(this.stopD,1),this.fetchBarchartdata(this.startD,this.stopD,this.aggregateview)):this.view=="month"?(this.startD=y(this.startD,1),this.stopD=y(this.stopD,1),this.fetchBarchartdata(this.startD,this.stopD,this.aggregateview)):this.view=="year"&&(this.startD=b(this.startD,1),this.stopD=b(this.stopD,1),this.fetchBarchartdata(this.startD,this.stopD,this.aggregateview))},dateForward:async function(){var t=new Date,e=new Date;this.view=="day"?(t.setHours(23,59,59,999),e=f(this.stopD,1),e.setHours(23,59,59,999),e<=t?(this.startD=f(this.startD,1),this.stopD=f(this.stopD,1),this.fetchBarchartdata(this.startD,this.stopD,this.aggregateview)):console.log("Date is in the future")):this.view=="month"?(t.setHours(23,59,59,999),e=_(this.stopD,1),e.setHours(23,59,59,999),e.getMonth<=t.getMonth?(this.startD=_(this.startD,1),this.stopD=_(this.stopD,1),this.fetchBarchartdata(this.startD,this.stopD,this.aggregateview)):console.log("Date is in the future")):this.view=="year"&&(t.setHours(23,59,59,999),this.stopD.getFullYear()<t.getFullYear()?(this.startD=B(this.startD,1),this.stopD=B(this.stopD,1),this.fetchBarchartdata(this.startD,this.stopD,this.aggregateview)):console.log("Date is in the future"))},actualDate:async function(){if(this.view=="day")this.startD=new Date,this.stopD=new Date,this.startD.setHours(0,0,0,1e3),this.stopD.setHours(23,59,59,999),this.fetchBarchartdata(this.startD,this.stopD,this.aggregateview);else if(this.view=="month"){let t=new Date,e=new Date(t.getFullYear(),t.getMonth(),1),l=new Date(t.getFullYear(),t.getMonth()+1,0);e.setHours(0,0,0,1e3),l.setHours(23,59,59,999),this.startD=e,this.stopD=l,console.log("StartD: "+this.startD),console.log("StopD: "+this.stopD),this.fetchBarchartdata(this.startD,this.stopD,this.aggregateview)}else if(this.view=="year"){let t=new Date,e=new Date(t.getFullYear(),0,1),l=new Date(t.getFullYear(),11,31);e.setHours(0,0,0,1e3),l.setHours(23,59,59,999),this.startD=e,this.stopD=l,this.fetchBarchartdata(this.startD,this.stopD,this.aggregateview)}},addDate:async function(){this.view=="day"?(this.startD=v(this.startD,1),this.fetchBarchartdata(this.startD,this.stopD,this.aggregateview)):this.view=="month"?(this.startD=y(this.startD,1),this.fetchBarchartdata(this.startD,this.stopD,this.aggregateview)):this.view=="year"&&(this.startD=b(this.startD,1),console.log("StartD: "+this.startD),console.log("StopD: "+this.stopD),this.fetchBarchartdata(this.startD,this.stopD,this.aggregateview))},removeDate:async function(){var t=new Date;this.view=="day"?(t=v(this.stopD,1),t.setHours(23,59,59,999),this.startD<=t&&(this.startD=f(this.startD,1),this.fetchBarchartdata(this.startD,this.stopD,this.aggregateview)),this.fetchBarchartdata(this.startD,this.stopD,this.aggregateview)):this.view=="month"?(t=y(this.stopD,1),t.setHours(23,59,59,999),this.startD<=t&&(this.startD=_(this.startD,1),this.fetchBarchartdata(this.startD,this.stopD,this.aggregateview))):this.view=="year"&&(t=b(this.stopD,1),t.setHours(23,59,59,999),this.startD<=t&&(this.startD=B(this.startD,1),this.fetchBarchartdata(this.startD,this.stopD,this.aggregateview)))},changeToDay:function(){this.view="day",this.aggregateview="1h",this.actualDate()},changeToMonth:function(){this.view="month",this.aggregateview="1d",this.actualDate()},changeToYear:function(){this.view="year",this.aggregateview="1mo",this.actualDate()},changeAggregate:function(t){this.aggregateview=t,this.fetchBarchartdata(this.startD,this.stopD,this.aggregateview)}},created(){this.fetchBarchartdata(void 0,void 0,this.aggregateview)},setup(){Y();const t=H();var e=new Date,l=new Date,i="day",m="1h";return{route:t,startD:e,stopD:l,view:i,aggregateview:m,useDateFormat:Q}}};const X={class:"container-fluid margin-container"},Z={class:"d-sm-flex justify-content-between align-items-center mb-4"},$={key:0,class:"text-dark mb-0"},x={key:1,class:"text-dark mb-0"},tt={key:2,class:"text-dark mb-0"},et={class:"btn-group",role:"group"},at={key:0,class:"dropdown"},st={class:"btn btn-primary dropdown-toggle btn-dropdown-grp",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},it={key:0},ot={key:1},rt={key:2},nt={key:3},ht={class:"dropdown-menu"},lt={key:1,class:"dropdown"},dt={class:"btn btn-primary dropdown-toggle",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},gt={key:0},ct={key:1},Dt={key:2},ut={class:"dropdown-menu"},mt={key:2,class:"dropdown"},wt={class:"btn btn-primary dropdown-toggle",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},pt={key:0},vt={key:1},ft={class:"dropdown-menu"},yt={class:"dropdown"},bt={class:"btn btn-primary dropdown-toggle btn-dropdown-grp",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},_t={key:0},kt={key:1},Bt={key:2},Ct={class:"dropdown-menu"},Ft={class:"row"},Et={class:"row"},At={class:"btn-group",role:"group"},Yt=a("i",{class:"icon-dateback"},null,-1),Ht=[Yt],St=a("i",{class:"icon-adddate"},null,-1),Tt=[St],Mt=a("i",{class:"icon-dateactual"},null,-1),It=[Mt],Ot=a("i",{class:"icon-dateremove"},null,-1),Nt=[Ot],Vt=a("i",{class:"icon-dateforward"},null,-1),Pt=[Vt],Lt={class:"row"},Rt={style:{position:"relative",height:"70vh",width:"97vw"}};function jt(t,e,l,i,m,s){const c=C("MainNavigation"),p=C("Bar");return n(),h(I,null,[T(c),a("main",null,[a("div",X,[a("div",Z,[i.view==="day"?(n(),h("h3",$,r(t.$t("dayview")),1)):i.view==="month"?(n(),h("h3",x,r(t.$t("monthview")),1)):i.view==="year"?(n(),h("h3",tt,r(t.$t("yearview")),1)):g("",!0),a("div",et,[i.view==="day"?(n(),h("div",at,[a("button",st,[i.aggregateview==="1m"?(n(),h("span",it,r(t.$t("one_minute")),1)):i.aggregateview==="5m"?(n(),h("span",ot,r(t.$t("five_minutes")),1)):i.aggregateview==="15m"?(n(),h("span",rt,r(t.$t("fifteen_minutes")),1)):i.aggregateview==="1h"?(n(),h("span",nt,r(t.$t("one_hour")),1)):g("",!0)]),a("ul",ht,[a("li",null,[a("a",{class:"dropdown-item",href:"#",onClick:e[0]||(e[0]=o=>s.changeAggregate("1m"))},r(t.$t("one_minute")),1)]),a("li",null,[a("a",{class:"dropdown-item",href:"#",onClick:e[1]||(e[1]=o=>s.changeAggregate("5m"))},r(t.$t("five_minutes")),1)]),a("li",null,[a("a",{class:"dropdown-item",href:"#",onClick:e[2]||(e[2]=o=>s.changeAggregate("15m"))},r(t.$t("fifteen_minutes")),1)]),a("li",null,[a("a",{class:"dropdown-item",href:"#",onClick:e[3]||(e[3]=o=>s.changeAggregate("1h"))},r(t.$t("one_hour")),1)])])])):g("",!0),i.view==="month"?(n(),h("div",lt,[a("button",dt,[i.aggregateview==="1h"?(n(),h("span",gt,r(t.$t("one_hour")),1)):i.aggregateview==="1d"?(n(),h("span",ct,r(t.$t("one_day")),1)):i.aggregateview==="1mo"?(n(),h("span",Dt,r(t.$t("one_month")),1)):g("",!0)]),a("ul",ut,[a("li",null,[a("a",{class:"dropdown-item",href:"#",onClick:e[4]||(e[4]=o=>s.changeAggregate("1h"))},r(t.$t("one_hour")),1)]),a("li",null,[a("a",{class:"dropdown-item",href:"#",onClick:e[5]||(e[5]=o=>s.changeAggregate("1d"))},r(t.$t("one_day")),1)]),a("li",null,[a("a",{class:"dropdown-item",href:"#",onClick:e[6]||(e[6]=o=>s.changeAggregate("1mo"))},r(t.$t("one_month")),1)])])])):g("",!0),i.view==="year"?(n(),h("div",mt,[a("button",wt,[i.aggregateview==="1d"?(n(),h("span",pt,r(t.$t("one_day")),1)):i.aggregateview==="1mo"?(n(),h("span",vt,r(t.$t("one_month")),1)):g("",!0)]),a("ul",ft,[a("li",null,[a("a",{class:"dropdown-item",href:"#",onClick:e[7]||(e[7]=o=>s.changeAggregate("1d"))},r(t.$t("one_day")),1)]),a("li",null,[a("a",{class:"dropdown-item",href:"#",onClick:e[8]||(e[8]=o=>s.changeAggregate("1mo"))},r(t.$t("one_month")),1)])])])):g("",!0),a("div",yt,[a("button",bt,[i.view==="day"?(n(),h("span",_t,r(t.$t("dayview")),1)):i.view==="month"?(n(),h("span",kt,r(t.$t("monthview")),1)):i.view==="year"?(n(),h("span",Bt,r(t.$t("yearview")),1)):g("",!0)]),a("ul",Ct,[a("li",null,[i.view!="day"?(n(),h("a",{key:0,class:"dropdown-item",href:"#",onClick:e[9]||(e[9]=(...o)=>s.changeToDay&&s.changeToDay(...o))},r(t.$t("dayview")),1)):g("",!0)]),a("li",null,[i.view!="month"?(n(),h("a",{key:0,class:"dropdown-item",href:"#",onClick:e[10]||(e[10]=(...o)=>s.changeToMonth&&s.changeToMonth(...o))},r(t.$t("monthview")),1)):g("",!0)]),a("li",null,[i.view!="year"?(n(),h("a",{key:0,class:"dropdown-item",href:"#",onClick:e[11]||(e[11]=(...o)=>s.changeToYear&&s.changeToYear(...o))},r(t.$t("yearview")),1)):g("",!0)])])])])]),a("div",Ft,[a("h6",null,r(i.useDateFormat(i.startD,"DD.MM.YYYY HH:mm").value)+" - "+r(i.useDateFormat(i.stopD,"DD.MM.YYYY HH:mm").value),1)]),a("div",Et,[a("div",At,[a("button",{type:"button",class:"btn btn-outline-primary","data-toggle":"tooltip","data-placement":"top",title:"Date back",onClick:e[12]||(e[12]=(...o)=>s.dateBack&&s.dateBack(...o))},Ht),a("button",{type:"button",class:"btn btn-outline-primary","data-toggle":"tooltip","data-placement":"top",title:"Add date",onClick:e[13]||(e[13]=(...o)=>s.addDate&&s.addDate(...o))},Tt),a("button",{type:"button",class:"btn btn-outline-primary","data-toggle":"tooltip","data-placement":"top",title:"Actual date",onClick:e[14]||(e[14]=(...o)=>s.actualDate&&s.actualDate(...o))},It),a("button",{type:"button",class:"btn btn-outline-primary","data-toggle":"tooltip","data-placement":"top",title:"Remove date",onClick:e[15]||(e[15]=(...o)=>s.removeDate&&s.removeDate(...o))},Nt),a("button",{type:"button",class:"btn btn-outline-primary","data-toggle":"tooltip","data-placement":"top",title:"Date forward",onClick:e[16]||(e[16]=(...o)=>s.dateForward&&s.dateForward(...o))},Pt)])]),a("div",Lt,[a("div",Rt,[t.chartloaded?(n(),M(p,{key:0,id:"my-chart-id",options:t.barChartOptions,data:t.barChartData},null,8,["options","data"])):g("",!0)])])])])],64)}const Kt=S(U,[["render",jt]]);export{Kt as default};
