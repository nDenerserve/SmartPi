import{b as I,k as H,u as S,d as Y,_ as T,f as A,o as r,c as l,g as M,a,t as o,i as u,l as B,F as U}from"./index-b0494a4f.js";import{g as E,C as O,p as V,a as N,b as R,A as j,d as q,L as z,e as W,f as G,P as J,T as K}from"./index-c7469127.js";import{s as f,a as y}from"./subDays-98de7d03.js";import{s as b,a as k,b as _,c as L}from"./subYears-8fb79fc4.js";import{u as Q}from"./index-d7652406.js";O.register(V,N,R,j,q,z,W,G,J,K);const X={name:"LinechartView",components:{MainNavigation:I,Line:E},data:()=>({chartloaded:!1,lineChartData:null,lineChartOptions:{pointStyle:!1,fill:!1,tension:.2,responsive:!0,maintainAspectRatio:!0,scales:{x:{title:{display:!0,text:"Time"}},yP:{title:{position:"left",display:!0,text:"W",color:"#004F15"},ticks:{reverse:!1,color:"#004F15"}},yU:{position:"right",title:{display:!0,text:"V",color:"#013541"},ticks:{reverse:!1,color:"#013541"}},yI:{position:"right",title:{display:!0,text:"A",color:"#690C00"},ticks:{reverse:!1,color:"#690C00"}},yF:{position:"left",title:{display:!0,text:"Hz",color:"#693400"},ticks:{reverse:!1,color:"#693400"}},yCosPhi:{position:"right",title:{display:!0,text:"cosPhi",color:"#1B307B"},ticks:{reverse:!1,color:"#1B307B"}}}}}),methods:{fetchLinechartdata:async function(t,e,c,s){this.chartloaded=!1;let p;console.log(s+" "+typeof s),typeof t>"u"&&(t="all"),typeof s>"u"&&(s="5m"),(typeof e>"u"||typeof c>"u")&&(console.log("DATE"),e=new Date,c=new Date,e.setHours(0,0,0,1e3),c.setHours(23,59,59,999)),p=`/smartpiac/progressdata/value/${t}/aggregate/${s}/starttime/${new Date(e).toISOString()}/stoptime/${new Date(c).toISOString()}`,Promise.all([H.get(p)]).then(i=>{const D=i[0].data.progressdatalist[0].data;var m,n=[D.length],C,h,d;m=[];for(let g=0;g<D.length;g++){C=[],typeof s>"u"&&(s="300s");for(let v=0;v<D[g].datapoint.length;v++){if(g==0){let w=new Intl.DateTimeFormat("de",{dateStyle:"short"});if(this.view=="day")e.getDate().valueOf()<c.getDate().valueOf()||e.getFullYear().valueOf()<c.getFullYear().valueOf()?w=new Intl.DateTimeFormat("de",{timeStyle:"short",dateStyle:"short"}):w=new Intl.DateTimeFormat("de",{timeStyle:"short"}),m.push(w.format(new Date(D[g].datapoint[v].time)));else if(this.view=="month"){if(s=="1d")m.push(w.format(new Date(D[g].datapoint[v].time)));else if(s=="1h")w=new Intl.DateTimeFormat("de",{timeStyle:"short",dateStyle:"short"}),m.push(w.format(new Date(D[g].datapoint[v].time)));else if(s=="1mo"){const F=new Intl.DateTimeFormat("de",{month:"short",year:"numeric"}).format;m.push(F(new Date(D[g].datapoint[v].time)))}}else if(this.view=="year"){let F=new Intl.DateTimeFormat("de",{dateStyle:"short"});if(s=="1mo"){const P=new Intl.DateTimeFormat("de",{month:"short",year:"numeric"}).format;m.push(P(new Date(D[g].datapoint[v].time)))}else s=="1d"&&m.push(F.format(new Date(D[g].datapoint[v].time)))}}C.push(D[g].datapoint[v].value)}switch(console.log("Linecolor: "+D[g].field),D[g].field){case"P":{h="#004F15",d="yP";break}case"P1":{h="#016E1E",d="yP";break}case"P2":{h="#25A246",d="yP";break}case"P3":{h="#45B262",d="yP";break}case"U1":{h="#044A5B",d="yU";break}case"U2":{h="#227386",d="yU";break}case"U3":{h="#3C8394",d="yU";break}case"I1":{h="#931302",d="yI";break}case"I2":{h="#D84532",d="yI";break}case"I3":{h="#D84532",d="yI";break}case"I4":{h="#D84532",d="yI";break}case"F1":{h="#934A02",d="yF";break}case"F2":{h="#D88432",d="yF";break}case"F3":{h="#EFA55D",d="yF";break}case"CosPhi1":{h="#0D2064",d="yCosPhi";break}case"CosPhi2":{h="#2F4493",d="yCosPhi";break}case"CosPhi3":{h="#4A5DA2",d="yCosPhi";break}default:{h="#10872F",d="y";break}}n[g]={label:D[g].field,borderColor:h,backgroundColor:h,data:C,yAxisID:d},console.log(n[g])}this.lineChartData={labels:m,datasets:n},this.chartloaded=!0}).catch(i=>{console.log(i)}),this.startD=e,this.stopD=c},dateBack:async function(){this.view=="day"?(this.startD=f(this.startD,1),this.stopD=f(this.stopD,1),this.fetchLinechartdata(this.valuelist,this.startD,this.stopD,this.aggregateview)):this.view=="month"?(this.startD=b(this.startD,1),this.stopD=b(this.stopD,1),this.fetchLinechartdata(this.valuelist,this.startD,this.stopD,this.aggregateview)):this.view=="year"&&(this.startD=k(this.startD,1),this.stopD=k(this.stopD,1),this.fetchLinechartdata(this.valuelist,this.startD,this.stopD,this.aggregateview))},dateForward:async function(){var t=new Date,e=new Date;this.view=="day"?(t.setHours(23,59,59,999),e=y(this.stopD,1),e.setHours(23,59,59,999),e<=t?(this.startD=y(this.startD,1),this.stopD=y(this.stopD,1),this.fetchLinechartdata(this.valuelist,this.startD,this.stopD,this.aggregateview)):console.log("Date is in the future")):this.view=="month"?(t.setHours(23,59,59,999),e=_(this.stopD,1),e.setHours(23,59,59,999),e.getMonth<=t.getMonth?(this.startD=_(this.startD,1),this.stopD=_(this.stopD,1),this.fetchLinechartdata(this.valuelist,this.startD,this.stopD,this.aggregateview)):console.log("Date is in the future")):this.view=="year"&&(t.setHours(23,59,59,999),this.stopD.getFullYear()<t.getFullYear()?(this.startD=L(this.startD,1),this.stopD=L(this.stopD,1),this.fetchLinechartdata(this.valuelist,this.startD,this.stopD,this.aggregateview)):console.log("Date is in the future"))},actualDate:async function(){if(this.view=="day")this.startD=new Date,this.stopD=new Date,this.startD.setHours(0,0,0,1e3),this.stopD.setHours(23,59,59,999),this.fetchLinechartdata(this.valuelist,this.startD,this.stopD,this.aggregateview);else if(this.view=="month"){let t=new Date,e=new Date(t.getFullYear(),t.getMonth(),1),c=new Date(t.getFullYear(),t.getMonth()+1,0);e.setHours(0,0,0,1e3),c.setHours(23,59,59,999),this.startD=e,this.stopD=c,console.log("StartD: "+this.startD),console.log("StopD: "+this.stopD),this.fetchLinechartdata(this.valuelist,this.startD,this.stopD,this.aggregateview)}else if(this.view=="year"){let t=new Date,e=new Date(t.getFullYear(),0,1),c=new Date(t.getFullYear(),11,31);e.setHours(0,0,0,1e3),c.setHours(23,59,59,999),this.startD=e,this.stopD=c,this.fetchLinechartdata(this.valuelist,this.startD,this.stopD,this.aggregateview)}},addDate:async function(){this.view=="day"?(this.startD=f(this.startD,1),this.fetchLinechartdata(this.valuelist,this.startD,this.stopD,this.aggregateview)):this.view=="month"?(this.startD=b(this.startD,1),this.fetchLinechartdata(this.valuelist,this.startD,this.stopD,this.aggregateview)):this.view=="year"&&(this.startD=k(this.startD,1),console.log("StartD: "+this.startD),console.log("StopD: "+this.stopD),this.fetchLinechartdata(this.valuelist,this.startD,this.stopD,this.aggregateview))},removeDate:async function(){var t=new Date;this.view=="day"?(t=f(this.stopD,1),t.setHours(23,59,59,999),this.startD<=t&&(this.startD=y(this.startD,1),this.fetchLinechartdata(this.valuelist,this.startD,this.stopD,this.aggregateview)),this.fetchLinechartdata(this.valuelist,this.startD,this.stopD,this.aggregateview)):this.view=="month"?(t=b(this.stopD,1),t.setHours(23,59,59,999),this.startD<=t&&(this.startD=_(this.startD,1),this.fetchLinechartdata(this.valuelist,this.startD,this.stopD,this.aggregateview))):this.view=="year"&&(t=k(this.stopD,1),t.setHours(23,59,59,999),this.startD<=t&&(this.startD=L(this.startD,1),this.fetchLinechartdata(this.valuelist,this.startD,this.stopD,this.aggregateview)))},changeToDay:function(){this.view="day",this.aggregateview="1h",this.actualDate()},changeToMonth:function(){this.view="month",this.aggregateview="1d",this.actualDate()},changeToYear:function(){this.view="year",this.aggregateview="1mo",this.actualDate()},changeAggregate:function(t){this.aggregateview=t,this.fetchLinechartdata(this.valuelist,this.startD,this.stopD,this.aggregateview)}},created(){this.fetchLinechartdata(this.valuelist,void 0,void 0,this.aggregateview)},setup(){S();const t=Y();var e=new Date,c=new Date,s="day",p="5m",i="P1,P2,P3,U1,U2,U3,I1,I2,I3,F1,F2,F3,CosPhi1,CosPhi2,CosPhi3";return{route:t,startD:e,stopD:c,view:s,aggregateview:p,useDateFormat:Q,valuelist:i}}};const Z={class:"container-fluid margin-container"},$={class:"d-sm-flex justify-content-between align-items-center mb-4"},x={key:0,class:"text-dark mb-0"},tt={key:1,class:"text-dark mb-0"},et={key:2,class:"text-dark mb-0"},at={class:"btn-group",role:"group"},st={key:0,class:"dropdown"},it={class:"btn btn-primary dropdown-toggle btn-dropdown-grp",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},ot={key:0},nt={key:1},rt={key:2},lt={key:3},ht={class:"dropdown-menu"},dt={key:1,class:"dropdown"},ct={class:"btn btn-primary dropdown-toggle",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},gt={key:0},Dt={key:1},ut={key:2},mt={class:"dropdown-menu"},vt={key:2,class:"dropdown"},wt={class:"btn btn-primary dropdown-toggle",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},pt={key:0},ft={key:1},yt={class:"dropdown-menu"},bt={class:"dropdown"},kt={class:"btn btn-primary dropdown-toggle btn-dropdown-grp",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},_t={key:0},Ct={key:1},Ft={key:2},Lt={class:"dropdown-menu"},At={class:"row"},Pt={class:"row"},It={class:"btn-group",role:"group"},Ht=a("i",{class:"icon-dateback"},null,-1),St=[Ht],Yt=a("i",{class:"icon-adddate"},null,-1),Tt=[Yt],Mt=a("i",{class:"icon-dateactual"},null,-1),Bt=[Mt],Ut=a("i",{class:"icon-dateremove"},null,-1),Et=[Ut],Ot=a("i",{class:"icon-dateforward"},null,-1),Vt=[Ot],Nt={class:"row"},Rt={style:{position:"relative",height:"70vh",width:"97vw"}};function jt(t,e,c,s,p,i){const D=A("MainNavigation"),m=A("Line");return r(),l(U,null,[M(D),a("main",null,[a("div",Z,[a("div",$,[s.view==="day"?(r(),l("h3",x,o(t.$t("dayview")),1)):s.view==="month"?(r(),l("h3",tt,o(t.$t("monthview")),1)):s.view==="year"?(r(),l("h3",et,o(t.$t("yearview")),1)):u("",!0),a("div",at,[s.view==="day"?(r(),l("div",st,[a("button",it,[s.aggregateview==="1m"?(r(),l("span",ot,o(t.$t("one_minute")),1)):s.aggregateview==="5m"?(r(),l("span",nt,o(t.$t("five_minutes")),1)):s.aggregateview==="15m"?(r(),l("span",rt,o(t.$t("fifteen_minutes")),1)):s.aggregateview==="1h"?(r(),l("span",lt,o(t.$t("one_hour")),1)):u("",!0)]),a("ul",ht,[a("li",null,[a("a",{class:"dropdown-item",href:"#",onClick:e[0]||(e[0]=n=>i.changeAggregate("1m"))},o(t.$t("one_minute")),1)]),a("li",null,[a("a",{class:"dropdown-item",href:"#",onClick:e[1]||(e[1]=n=>i.changeAggregate("5m"))},o(t.$t("five_minutes")),1)]),a("li",null,[a("a",{class:"dropdown-item",href:"#",onClick:e[2]||(e[2]=n=>i.changeAggregate("15m"))},o(t.$t("fifteen_minutes")),1)]),a("li",null,[a("a",{class:"dropdown-item",href:"#",onClick:e[3]||(e[3]=n=>i.changeAggregate("1h"))},o(t.$t("one_hour")),1)])])])):u("",!0),s.view==="month"?(r(),l("div",dt,[a("button",ct,[s.aggregateview==="1h"?(r(),l("span",gt,o(t.$t("one_hour")),1)):s.aggregateview==="1d"?(r(),l("span",Dt,o(t.$t("one_day")),1)):s.aggregateview==="1mo"?(r(),l("span",ut,o(t.$t("one_month")),1)):u("",!0)]),a("ul",mt,[a("li",null,[a("a",{class:"dropdown-item",href:"#",onClick:e[4]||(e[4]=n=>i.changeAggregate("1h"))},o(t.$t("one_hour")),1)]),a("li",null,[a("a",{class:"dropdown-item",href:"#",onClick:e[5]||(e[5]=n=>i.changeAggregate("1d"))},o(t.$t("one_day")),1)]),a("li",null,[a("a",{class:"dropdown-item",href:"#",onClick:e[6]||(e[6]=n=>i.changeAggregate("1mo"))},o(t.$t("one_month")),1)])])])):u("",!0),s.view==="year"?(r(),l("div",vt,[a("button",wt,[s.aggregateview==="1d"?(r(),l("span",pt,o(t.$t("one_day")),1)):s.aggregateview==="1mo"?(r(),l("span",ft,o(t.$t("one_month")),1)):u("",!0)]),a("ul",yt,[a("li",null,[a("a",{class:"dropdown-item",href:"#",onClick:e[7]||(e[7]=n=>i.changeAggregate("1d"))},o(t.$t("one_day")),1)]),a("li",null,[a("a",{class:"dropdown-item",href:"#",onClick:e[8]||(e[8]=n=>i.changeAggregate("1mo"))},o(t.$t("one_month")),1)])])])):u("",!0),a("div",bt,[a("button",kt,[s.view==="day"?(r(),l("span",_t,o(t.$t("dayview")),1)):s.view==="month"?(r(),l("span",Ct,o(t.$t("monthview")),1)):s.view==="year"?(r(),l("span",Ft,o(t.$t("yearview")),1)):u("",!0)]),a("ul",Lt,[a("li",null,[s.view!="day"?(r(),l("a",{key:0,class:"dropdown-item",href:"#",onClick:e[9]||(e[9]=(...n)=>i.changeToDay&&i.changeToDay(...n))},o(t.$t("dayview")),1)):u("",!0)]),a("li",null,[s.view!="month"?(r(),l("a",{key:0,class:"dropdown-item",href:"#",onClick:e[10]||(e[10]=(...n)=>i.changeToMonth&&i.changeToMonth(...n))},o(t.$t("monthview")),1)):u("",!0)]),a("li",null,[s.view!="year"?(r(),l("a",{key:0,class:"dropdown-item",href:"#",onClick:e[11]||(e[11]=(...n)=>i.changeToYear&&i.changeToYear(...n))},o(t.$t("yearview")),1)):u("",!0)])])])])]),a("div",At,[a("h6",null,o(s.useDateFormat(s.startD,"DD.MM.YYYY HH:mm").value)+" - "+o(s.useDateFormat(s.stopD,"DD.MM.YYYY HH:mm").value),1)]),a("div",Pt,[a("div",It,[a("button",{type:"button",class:"btn btn-outline-primary","data-toggle":"tooltip","data-placement":"top",title:"Date back",onClick:e[12]||(e[12]=(...n)=>i.dateBack&&i.dateBack(...n))},St),a("button",{type:"button",class:"btn btn-outline-primary","data-toggle":"tooltip","data-placement":"top",title:"Add date",onClick:e[13]||(e[13]=(...n)=>i.addDate&&i.addDate(...n))},Tt),a("button",{type:"button",class:"btn btn-outline-primary","data-toggle":"tooltip","data-placement":"top",title:"Actual date",onClick:e[14]||(e[14]=(...n)=>i.actualDate&&i.actualDate(...n))},Bt),a("button",{type:"button",class:"btn btn-outline-primary","data-toggle":"tooltip","data-placement":"top",title:"Remove date",onClick:e[15]||(e[15]=(...n)=>i.removeDate&&i.removeDate(...n))},Et),a("button",{type:"button",class:"btn btn-outline-primary","data-toggle":"tooltip","data-placement":"top",title:"Date forward",onClick:e[16]||(e[16]=(...n)=>i.dateForward&&i.dateForward(...n))},Vt)])]),a("div",Nt,[a("div",Rt,[t.chartloaded?(r(),B(m,{key:0,id:"my-chart-id",options:t.lineChartOptions,data:t.lineChartData},null,8,["options","data"])):u("",!0)])])])])],64)}const Kt=T(X,[["render",jt]]);export{Kt as default};
