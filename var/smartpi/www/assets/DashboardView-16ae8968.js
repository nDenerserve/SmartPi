import{b as A,k as b,u as C,d as B,_ as P,f as F,o as n,c as p,g as $,a as e,t as o,i as g,l as k,F as W}from"./index-b0494a4f.js";import{B as E,C as x,p as S,a as q,b as I,A as T,c as O,d as V,L,e as M,f as N,P as j,T as Y}from"./index-c7469127.js";import{u as R}from"./index-d7652406.js";x.register(S,q,I,T,O,V,L,M,N,j,Y);const H={name:"DashboardView",components:{MainNavigation:A,Bar:E},data:()=>({loaded:!1,monthchartloaded:!1,daychartloaded:!1,data:null,ptot:0,itot:0,power:null,voltage:null,current:null,energyConsumed:null,energyProduced:null,energyBalanced:null,cosPhi:null,frequency:null,monthBarChartData:null,dayBarChartData:null,barChartOptions:{responsive:!0,maintainAspectRatio:!1,scales:{x:{title:{display:!0,text:"Time"},stacked:!0,categoryPercentage:.5,barPercentage:1},y:{title:{display:!0,text:"kWh"},stacked:!0,ticks:{reverse:!1}}},plugins:{}}}),methods:{loadLivevalues:async function(){this.loaded=!1;var t=0,i=0,c=new Array,r=new Array,u=new Array,y=new Array,f=new Array,l=new Array,h=new Array,_=new Array;try{const{data:d}=await b.get("/smartpiac/livedata");console.log(d);for(let a=0;a<d.datasets[0].phases.length;a++)for(let s=0;s<d.datasets[0].phases[a].values.length;s++)d.datasets[0].phases[a].values[s].type=="power"?(t=t+d.datasets[0].phases[a].values[s].data,c[a]=d.datasets[0].phases[a].values[s].data):d.datasets[0].phases[a].values[s].type=="voltage"?r[a]=d.datasets[0].phases[a].values[s].data:d.datasets[0].phases[a].values[s].type=="current"?((a<3||a==3&&d.datasets[0].phases[a].values[s].data>0)&&(u[a]=d.datasets[0].phases[a].values[s].data),i=i+d.datasets[0].phases[a].values[s].data):d.datasets[0].phases[a].values[s].type=="energyproduced"?f[a]=d.datasets[0].phases[a].values[s].data:d.datasets[0].phases[a].values[s].type=="energyconsumed"?y[a]=d.datasets[0].phases[a].values[s].data:d.datasets[0].phases[a].values[s].type=="energybalanced"?l[a]=d.datasets[0].phases[a].values[s].data:d.datasets[0].phases[a].values[s].type=="cosphi"?h[a]=d.datasets[0].phases[a].values[s].data:d.datasets[0].phases[a].values[s].type=="frequency"&&(_[a]=d.datasets[0].phases[a].values[s].data);this.ptot=t,this.itot=i,this.power=c,this.voltage=r,this.current=u,this.energyConsumed=y,this.energyProduced=f,this.energyBalanced=l,this.cosPhi=h,this.frequency=_,this.data=d,this.loaded=!0}catch(d){console.error(d)}},updateLivevalues:async function(){var t=0,i=0,c=new Array,r=new Array,u=new Array,y=new Array,f=new Array,l=new Array,h=new Array,_=new Array;try{const{data:d}=await b.get("/smartpiac/livedata");for(let a=0;a<d.datasets[0].phases.length;a++)for(let s=0;s<d.datasets[0].phases[a].values.length;s++)d.datasets[0].phases[a].values[s].type=="power"?(t=t+d.datasets[0].phases[a].values[s].data,c[a]=d.datasets[0].phases[a].values[s].data):d.datasets[0].phases[a].values[s].type=="voltage"?r[a]=d.datasets[0].phases[a].values[s].data:d.datasets[0].phases[a].values[s].type=="current"?((a<3||a==3&&d.datasets[0].phases[a].values[s].data>0)&&(u[a]=d.datasets[0].phases[a].values[s].data),i=i+d.datasets[0].phases[a].values[s].data):d.datasets[0].phases[a].values[s].type=="energyproduced"?f[a]=d.datasets[0].phases[a].values[s].data:d.datasets[0].phases[a].values[s].type=="energyconsumed"?y[a]=d.datasets[0].phases[a].values[s].data:d.datasets[0].phases[a].values[s].type=="energybalanced"?l[a]=d.datasets[0].phases[a].values[s].data:d.datasets[0].phases[a].values[s].type=="cosphi"?h[a]=d.datasets[0].phases[a].values[s].data:d.datasets[0].phases[a].values[s].type=="frequency"&&(_[a]=d.datasets[0].phases[a].values[s].data);this.ptot=t,this.itot=i,this.power=c,this.voltage=r,this.current=u,this.energyConsumed=y,this.energyProduced=f,this.energyBalanced=l,this.cosPhi=h,this.frequency=_,this.data=d}catch(d){console.error(d)}},getMonthdata(){},fetchBarchartdata:async function(t,i,c,r){t=="day"?this.daychartloaded=!1:t=="month"&&(this.monthchartloaded=!1);let u,y;console.log(r+" "+typeof r),(typeof i>"u"||typeof c>"u")&&(i=new Date,c=new Date,t=="day"?this.daychartloaded=!1:t=="month"&&(this.monthchartloaded=!1,y=new Date,i=new Date(y.getFullYear(),y.getMonth(),1),c=new Date(y.getFullYear(),y.getMonth()+1,0)),i.setHours(0,0,0,1e3),c.setHours(23,59,59,999)),typeof r<"u"?u=`/smartpiac/barchart/value/energy/aggregate/${r}/starttime/${new Date(i).toISOString()}/stoptime/${new Date(c).toISOString()}`:u="/smartpiac/barchart/value/energy/aggregate",Promise.all([b.get(u)]).then(f=>{const l=f[0].data.progressdatalist[0].data;var h,_=[l.length],d,a;h=[];for(let s=0;s<l.length;s++){d=[],typeof r>"u"&&(r="1d");for(let v=0;v<l[s].datapoint.length;v++){if(s==0){let m=new Intl.DateTimeFormat("de",{dateStyle:"short"});if(t=="day")i.getDate().valueOf()<c.getDate().valueOf()||i.getFullYear().valueOf()<c.getFullYear().valueOf()?m=new Intl.DateTimeFormat("de",{timeStyle:"short",dateStyle:"short"}):m=new Intl.DateTimeFormat("de",{timeStyle:"short"}),h.push(m.format(new Date(l[s].datapoint[v].time)));else if(t=="month"){if(r=="1d")h.push(m.format(new Date(l[s].datapoint[v].time)));else if(r=="1h")m=new Intl.DateTimeFormat("de",{timeStyle:"short",dateStyle:"short"}),h.push(m.format(new Date(l[s].datapoint[v].time)));else if(r=="1mo"){const w=new Intl.DateTimeFormat("de",{month:"short",year:"numeric"}).format;h.push(w(new Date(l[s].datapoint[v].time)))}}else if(t=="year"){let w=new Intl.DateTimeFormat("de",{dateStyle:"short"});if(r=="1mo"){const D=new Intl.DateTimeFormat("de",{month:"short",year:"numeric"}).format;h.push(D(new Date(l[s].datapoint[v].time)))}else r=="1d"&&h.push(w.format(new Date(l[s].datapoint[v].time)))}}l[s].field.includes("Ep")?d.push(l[s].datapoint[v].value/1e3*-1):d.push(l[s].datapoint[v].value/1e3)}switch(l[s].field){case"Ep1":{a="#E2AE12";break}case"Ep2":{a="#EEBE2F";break}case"Ep3":{a="#F1CA55";break}case"Ec1":{a="#36A2EB";break}case"Ec2":{a="#36A2EB";break}case"Ec3":{a="#6ABBF0";break}default:{a="#F25757";break}}_[s]={label:l[s].field,backgroundColor:a,data:d},console.log(_[s])}t=="day"?(this.dayBarChartData={labels:h,datasets:_},this.daychartloaded=!0):t=="month"&&(this.monthBarChartData={labels:h,datasets:_},this.monthchartloaded=!0)}).catch(f=>{console.log(f)}),this.startD=i,this.stopD=c}},created(){this.loadLivevalues(),setInterval(async()=>{this.updateLivevalues()},3e3),this.fetchBarchartdata("month",void 0,void 0,"1d"),this.fetchBarchartdata("day",void 0,void 0,"1h")},setup(){C();const t=B();var i=new Date,c=new Date,r="1h";return{route:t,startD:i,stopD:c,aggregateview:r,useDateFormat:R}}};const z={class:"container-fluid margin-container"},G={class:"d-sm-flex justify-content-between align-items-center mb-4"},J={class:"text-dark mb-0"},K={class:"row"},Q={class:"col-xl-4 col-sm-12 col-12"},U={class:"card height300"},X={class:"card-content"},Z={class:"card-body"},ee={class:"media d-flex"},te=e("i",{class:"icon-flash primary font-large-2 float-left"},null,-1),ae={class:"media-body text-right"},se={key:0,class:"text-green-d1"},oe={key:1},de={key:2,class:"table card-table text-primary"},le=e("thead",null,[e("tr",null,[e("th",{scope:"col"}),e("th",{scope:"col"},"1"),e("th",{scope:"col"},"2"),e("th",{scope:"col"},"3")])],-1),re={key:0},ie={scope:"row"},ce={class:"card-text-field"},ne={class:"card-text-field"},he={class:"card-text-field"},pe={key:1},ue={scope:"row"},ye={class:"card-text-field"},fe={class:"card-text-field"},_e={class:"card-text-field"},ve={key:2},me={scope:"row"},ge={class:"card-text-field"},we={class:"card-text-field"},be={class:"card-text-field"},Fe={key:3},ke={scope:"row"},De={class:"card-text-field"},Ae={class:"card-text-field"},Ce={class:"card-text-field"},Be={key:4},Pe={scope:"row"},$e={class:"card-text-field"},We={class:"card-text-field"},Ee={class:"card-text-field"},xe={key:5},Se={scope:"row"},qe={class:"card-text-field"},Ie={class:"card-text-field"},Te={class:"card-text-field"},Oe={class:"col-xl-4 col-sm-12 col-12"},Ve={class:"card height300"},Le={class:"card-content"},Me={class:"card-body"},Ne={class:"media d-flex"},je=e("i",{class:"icon-socket font-large-2 float-left"},null,-1),Ye={class:"media-body text-right"},Re={key:0,class:"text-green-d1"},He={key:1},ze={key:2,class:"table card-table text-primary"},Ge=e("thead",null,[e("tr",null,[e("th",{scope:"col"}),e("th",{scope:"col"},"1"),e("th",{scope:"col"},"2"),e("th",{scope:"col"},"3")])],-1),Je={key:0},Ke={scope:"row"},Qe={class:"card-text-field"},Ue={class:"card-text-field"},Xe={class:"card-text-field"},Ze={key:1},et={scope:"row"},tt={class:"card-text-field"},at={class:"card-text-field"},st={class:"card-text-field"},ot={scope:"row"},dt={class:"card-text-field"},lt={class:"card-text-field"},rt={class:"card-text-field"},it={scope:"row"},ct={class:"card-text-field"},nt={class:"card-text-field"},ht={class:"card-text-field"},pt={scope:"row"},ut={class:"card-text-field"},yt={class:"card-text-field"},ft={class:"card-text-field"},_t={class:"col-xl-4 col-sm-12 col-12"},vt={class:"card height300"},mt={class:"card-content"},gt={class:"card-body"},wt={class:"media d-flex"},bt=e("i",{class:"icon-info-square-solid float-left"},null,-1),Ft={class:"media-body text-right text-primary card-infocard"},kt={class:"text-green-d1"},Dt={class:"card-space-between"},At={class:"card-space-between"},Ct={class:"card-space-between"},Bt={class:"card-space-between"},Pt={class:"row"},$t={class:"col-xl-6 col-sm-12 col-12"},Wt={class:"card shadow mb-4 height300"},Et={class:"card-body"},xt={class:"media d-flex"},St=e("i",{class:"icon-calendar-day-solid primary font-large-2 float-left"},null,-1),qt={class:"media-body text-right"},It={class:"chart-area"},Tt={class:"col-xl-6 col-sm-12 col-12"},Ot={class:"card shadow mb-4 height300"},Vt={class:"card-body"},Lt={class:"media d-flex"},Mt=e("i",{class:"icon-calendar-month-solid primary font-large-2 float-left"},null,-1),Nt={class:"media-body text-right"},jt={class:"chart-area"};function Yt(t,i,c,r,u,y){const f=F("MainNavigation"),l=F("Bar");return n(),p(W,null,[$(f),e("main",null,[e("div",z,[e("div",G,[e("h3",J,o(t.$t("dashboard")),1)]),e("div",K,[e("div",Q,[e("div",U,[e("div",X,[e("div",Z,[e("div",ee,[te,e("div",ae,[t.ptot<1e4?(n(),p("h3",se,o(t.ptot.toFixed(2).replace(".",",").replace(" ",""))+" W",1)):(n(),p("h3",oe,o((t.ptot/1e3).toFixed(3).replace(".",",").replace(" ",""))+" kW",1)),t.loaded?(n(),p("table",de,[le,e("tbody",null,[t.power[0]<1e4&&t.power[1]<1e4&&t.power[2]<1e4?(n(),p("tr",re,[e("th",ie,o(t.$t("power")),1),e("td",ce,o(t.power[0].toFixed(2).replace(".",",").replace(" ",""))+" W",1),e("td",ne,o(t.power[1].toFixed(2).replace(".",",").replace(" ",""))+" W",1),e("td",he,o(t.power[2].toFixed(2).replace(".",",").replace(" ",""))+" W",1)])):(n(),p("tr",pe,[e("th",ue,o(t.$t("power")),1),e("td",ye,o((t.power[0]/1e3).toFixed(3).replace(".",",").replace(" ",""))+" kW",1),e("td",fe,o((t.power[1]/1e3).toFixed(3).replace(".",",").replace(" ",""))+" kW",1),e("td",_e,o((t.power[2]/1e3).toFixed(3).replace(".",",").replace(" ",""))+" kW",1)])),t.energyConsumed[0]<1e4&&t.energyConsumed[1]<1e4&&t.energyConsumed[2]<1e4?(n(),p("tr",ve,[e("th",me,o(t.$t("energyconsumption")),1),e("td",ge,o(t.energyConsumed[0].toFixed(2).replace(".",",").replace(" ",""))+" Wh ",1),e("td",we,o(t.energyConsumed[1].toFixed(2).replace(".",",").replace(" ",""))+" Wh",1),e("td",be,o(t.energyConsumed[2].toFixed(2).replace(".",",").replace(" ",""))+" Wh",1)])):(n(),p("tr",Fe,[e("th",ke,o(t.$t("energyconsumption")),1),e("td",De,o((t.energyConsumed[0]/1e3).toFixed(3).replace(".",",").replace(" ",""))+" kWh",1),e("td",Ae,o((t.energyConsumed[1]/1e3).toFixed(3).replace(".",",").replace(" ",""))+" kWh",1),e("td",Ce,o((t.energyConsumed[2]/1e3).toFixed(3).replace(".",",").replace(" ",""))+" kWh",1)])),t.energyProduced[0]<1e4&&t.energyProduced[1]<1e4&&t.energyProduced[2]<1e4?(n(),p("tr",Be,[e("th",Pe,o(t.$t("energyproduction")),1),e("td",$e,o(t.energyProduced[0].toFixed(2).replace(".",",").replace(" ",""))+" Wh ",1),e("td",We,o(t.energyProduced[1].toFixed(2).replace(".",",").replace(" ",""))+" Wh",1),e("td",Ee,o(t.energyProduced[2].toFixed(2).replace(".",",").replace(" ",""))+" Wh",1)])):(n(),p("tr",xe,[e("th",Se,o(t.$t("energyproduction")),1),e("td",qe,o((t.energyProduced[0]/1e3).toFixed(3).replace(".",",").replace(" ",""))+" kWh",1),e("td",Ie,o((t.energyProduced[1]/1e3).toFixed(3).replace(".",",").replace(" ",""))+" kWh",1),e("td",Te,o((t.energyProduced[2]/1e3).toFixed(3).replace(".",",").replace(" ",""))+" kWh",1)]))])])):g("",!0)])])])])])]),e("div",Oe,[e("div",Ve,[e("div",Le,[e("div",Me,[e("div",Ne,[je,e("div",Ye,[t.itot<1e4?(n(),p("h3",Re,o(t.itot.toFixed(2).replace(".",",").replace(" ",""))+" A",1)):(n(),p("h3",He,o((t.itot/1e3).toFixed(3).replace(".",",").replace(" ",""))+" kA",1)),t.loaded?(n(),p("table",ze,[Ge,e("tbody",null,[t.current[0]<1e4&&t.current[1]<1e4&&t.current[2]<1e4?(n(),p("tr",Je,[e("th",Ke,o(t.$t("current")),1),e("td",Qe,o(t.current[0].toFixed(2).replace(".",",").replace(" ",""))+" A",1),e("td",Ue,o(t.current[1].toFixed(2).replace(".",",").replace(" ",""))+" A",1),e("td",Xe,o(t.current[2].toFixed(2).replace(".",",").replace(" ",""))+" A",1)])):(n(),p("tr",Ze,[e("th",et,o(t.$t("current")),1),e("td",tt,o((t.current[0]/1e3).toFixed(3).replace(".",",").replace(" ",""))+" kA",1),e("td",at,o((t.current[1]/1e3).toFixed(3).replace(".",",").replace(" ",""))+" kA",1),e("td",st,o((t.current[2]/1e3).toFixed(3).replace(".",",").replace(" ",""))+" kA",1)])),e("tr",null,[e("th",ot,o(t.$t("voltage")),1),e("td",dt,o(t.voltage[0].toFixed(2).replace(".",",").replace(" ",""))+" V",1),e("td",lt,o(t.voltage[1].toFixed(2).replace(".",",").replace(" ",""))+" V",1),e("td",rt,o(t.voltage[2].toFixed(2).replace(".",",").replace(" ",""))+" V",1)]),e("tr",null,[e("th",it,o(t.$t("cosphi")),1),e("td",ct,o(t.cosPhi[0].toFixed(2).replace(".",",").replace(" ","")),1),e("td",nt,o(t.cosPhi[1].toFixed(2).replace(".",",").replace(" ","")),1),e("td",ht,o(t.cosPhi[2].toFixed(2).replace(".",",").replace(" ","")),1)]),e("tr",null,[e("th",pt,o(t.$t("frequency")),1),e("td",ut,o(t.frequency[0].toFixed(2).replace(".",",").replace(" ","")),1),e("td",yt,o(t.frequency[1].toFixed(2).replace(".",",").replace(" ","")),1),e("td",ft,o(t.frequency[2].toFixed(2).replace(".",",").replace(" ","")),1)])])])):g("",!0)])])])])])]),e("div",_t,[e("div",vt,[e("div",mt,[e("div",gt,[e("div",wt,[bt,e("div",Ft,[e("h3",kt,o(t.data.name),1),e("div",Dt,[e("div",null,o(t.$t("serialnumber")),1),e("div",null,o(t.data.serial),1)]),e("div",At,[e("div",null,o(t.$t("ipaddress")),1),e("div",null,o(t.data.ipaddress),1)]),e("div",Ct,[e("div",null,o(t.$t("datatime")),1),e("div",null,o(t.data.datasets[0].time),1)]),e("div",Bt,[e("div",null,o(t.$t("calltime")),1),e("div",null,o(t.data.time),1)])])])])])])])]),e("div",Pt,[e("div",$t,[e("div",Wt,[e("div",Et,[e("div",xt,[St,e("div",qt,[e("div",It,[t.daychartloaded?(n(),k(l,{key:0,class:"height250",id:"day-chart",options:t.barChartOptions,loaded:t.daychartloaded,data:t.dayBarChartData},null,8,["options","loaded","data"])):g("",!0)])])])])])]),e("div",Tt,[e("div",Ot,[e("div",Vt,[e("div",Lt,[Mt,e("div",Nt,[e("div",jt,[t.monthchartloaded?(n(),k(l,{key:0,class:"height250",id:"month-chart",options:t.barChartOptions,loaded:t.monthchartloaded,data:t.monthBarChartData},null,8,["options","loaded","data"])):g("",!0)])])])])])])])])])],64)}const Gt=P(H,[["render",Yt]]);export{Gt as default};
